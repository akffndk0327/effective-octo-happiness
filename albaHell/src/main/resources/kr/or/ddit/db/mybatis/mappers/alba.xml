<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="kr.or.ddit.alba.dao.IAlbaDao">

<select id="selectAlbaList" resultType="AlbaVO" >
	SELECT
	    AL_ID,    AL_NAME,    AL_AGE,    AL_ADDRESS
	FROM   ALBA
</select>
<resultMap type="AlbaVO" id="albaMap" autoMapping="true">
      <id column="AL_ID" property="al_id"/>
      <association property="grade" javaType="GradeVO" autoMapping="true">
         <id column="GR_CODE" property="gr_code"/>
      </association>
      <collection  property="licAlbaLists" ofType="Lic_albaVO" autoMapping="true">
         <id column="AL_ID" property="al_id"/>
         <id column="LIC_CODE" property="lic_code"/>
         <collection property="licenseList" ofType="LicenseVO" autoMapping="true">
            <id column="LIC_CODE" property="lic_code"/>
         </collection>
      </collection>
   </resultMap>
<select id = "selctAlba" parameterType="AlbaVO"	resultMap="albaMap">
	SELECT
	    A.AL_ID,		AL_NAME,		    AL_AGE,		    AL_ADDRESS,
	    AL_HP,		    AL_SPEC,		    AL_DESC,		A.GR_CODE,
	    AL_CAREER,		AL_GEN,		    	AL_BTYPE,		AL_MAIL
	    , GR_NAME
	    , C.LIC_CODE, LIC_NAME
FROM ALBA A INNER JOIN GRADE B ON (A.GR_CODE = B.GR_CODE)
            LEFT OUTER JOIN LIC_ALBA C ON (A.AL_ID = C.AL_ID)
            LEFT OUTER JOIN LICENSE D ON (C.LIC_CODE = D.LIC_CODE)
WHERE A.AL_ID = #{al_id}
</select>

</mapper>